(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2114],{4885:function(e,t,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/properties/[id]/summary",function(){return o(3336)}])},7443:function(e,t,o){"use strict";var r=o(3454);o(1479);var n=o(7294),a=n&&"object"==typeof n&&"default"in n?n:{default:n},s=void 0!==r&&r.env&&!0,l=function(e){return"[object String]"===Object.prototype.toString.call(e)},i=function(){function e(e){var t=void 0===e?{}:e,o=t.name,r=void 0===o?"stylesheet":o,n=t.optimizeForSpeed,a=void 0===n?s:n;d(l(r),"`name` must be a string"),this._name=r,this._deletedRulePlaceholder="#"+r+"-deleted-rule____{}",d("boolean"==typeof a,"`optimizeForSpeed` must be a boolean"),this._optimizeForSpeed=a,this._serverSheet=void 0,this._tags=[],this._injected=!1,this._rulesCount=0;var i=document.querySelector('meta[property="csp-nonce"]');this._nonce=i?i.getAttribute("content"):null}var t=e.prototype;return t.setOptimizeForSpeed=function(e){d("boolean"==typeof e,"`setOptimizeForSpeed` accepts a boolean"),d(0===this._rulesCount,"optimizeForSpeed cannot be when rules have already been inserted"),this.flush(),this._optimizeForSpeed=e,this.inject()},t.isOptimizeForSpeed=function(){return this._optimizeForSpeed},t.inject=function(){var e=this;if(d(!this._injected,"sheet already injected"),this._injected=!0,this._optimizeForSpeed){this._tags[0]=this.makeStyleTag(this._name),this._optimizeForSpeed="insertRule"in this.getSheet(),this._optimizeForSpeed||(s||console.warn("StyleSheet: optimizeForSpeed mode not supported falling back to standard mode."),this.flush(),this._injected=!0);return}this._serverSheet={cssRules:[],insertRule:function(t,o){return"number"==typeof o?e._serverSheet.cssRules[o]={cssText:t}:e._serverSheet.cssRules.push({cssText:t}),o},deleteRule:function(t){e._serverSheet.cssRules[t]=null}}},t.getSheetForTag=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]},t.getSheet=function(){return this.getSheetForTag(this._tags[this._tags.length-1])},t.insertRule=function(e,t){if(d(l(e),"`insertRule` accepts only strings"),this._optimizeForSpeed){var o=this.getSheet();"number"!=typeof t&&(t=o.cssRules.length);try{o.insertRule(e,t)}catch(t){return s||console.warn("StyleSheet: illegal rule: \n\n"+e+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),-1}}else{var r=this._tags[t];this._tags.push(this.makeStyleTag(this._name,e,r))}return this._rulesCount++},t.replaceRule=function(e,t){if(this._optimizeForSpeed){var o=this.getSheet();if(t.trim()||(t=this._deletedRulePlaceholder),!o.cssRules[e])return e;o.deleteRule(e);try{o.insertRule(t,e)}catch(r){s||console.warn("StyleSheet: illegal rule: \n\n"+t+"\n\nSee https://stackoverflow.com/q/20007992 for more info"),o.insertRule(this._deletedRulePlaceholder,e)}}else{var r=this._tags[e];d(r,"old rule at index `"+e+"` not found"),r.textContent=t}return e},t.deleteRule=function(e){if(this._optimizeForSpeed)this.replaceRule(e,"");else{var t=this._tags[e];d(t,"rule at index `"+e+"` not found"),t.parentNode.removeChild(t),this._tags[e]=null}},t.flush=function(){this._injected=!1,this._rulesCount=0,this._tags.forEach(function(e){return e&&e.parentNode.removeChild(e)}),this._tags=[]},t.cssRules=function(){var e=this;return this._tags.reduce(function(t,o){return o?t=t.concat(Array.prototype.map.call(e.getSheetForTag(o).cssRules,function(t){return t.cssText===e._deletedRulePlaceholder?null:t})):t.push(null),t},[])},t.makeStyleTag=function(e,t,o){t&&d(l(t),"makeStyleTag accepts only strings as second parameter");var r=document.createElement("style");this._nonce&&r.setAttribute("nonce",this._nonce),r.type="text/css",r.setAttribute("data-"+e,""),t&&r.appendChild(document.createTextNode(t));var n=document.head||document.getElementsByTagName("head")[0];return o?n.insertBefore(r,o):n.appendChild(r),r},function(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,[{key:"length",get:function(){return this._rulesCount}}]),e}();function d(e,t){if(!e)throw Error("StyleSheet: "+t+".")}var c=function(e){for(var t=5381,o=e.length;o;)t=33*t^e.charCodeAt(--o);return t>>>0},p={};function u(e,t){if(!t)return"jsx-"+e;var o=String(t),r=e+o;return p[r]||(p[r]="jsx-"+c(e+"-"+o)),p[r]}function h(e,t){var o=e+t;return p[o]||(p[o]=t.replace(/__jsx-style-dynamic-selector/g,e)),p[o]}var m=function(){function e(e){var t=void 0===e?{}:e,o=t.styleSheet,r=void 0===o?null:o,n=t.optimizeForSpeed,a=void 0!==n&&n;this._sheet=r||new i({name:"styled-jsx",optimizeForSpeed:a}),this._sheet.inject(),r&&"boolean"==typeof a&&(this._sheet.setOptimizeForSpeed(a),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer=void 0,this._indices={},this._instancesCounts={}}var t=e.prototype;return t.add=function(e){var t=this;void 0===this._optimizeForSpeed&&(this._optimizeForSpeed=Array.isArray(e.children),this._sheet.setOptimizeForSpeed(this._optimizeForSpeed),this._optimizeForSpeed=this._sheet.isOptimizeForSpeed()),this._fromServer||(this._fromServer=this.selectFromServer(),this._instancesCounts=Object.keys(this._fromServer).reduce(function(e,t){return e[t]=0,e},{}));var o=this.getIdAndRules(e),r=o.styleId,n=o.rules;if(r in this._instancesCounts){this._instancesCounts[r]+=1;return}var a=n.map(function(e){return t._sheet.insertRule(e)}).filter(function(e){return -1!==e});this._indices[r]=a,this._instancesCounts[r]=1},t.remove=function(e){var t=this,o=this.getIdAndRules(e).styleId;if(function(e,t){if(!e)throw Error("StyleSheetRegistry: "+t+".")}(o in this._instancesCounts,"styleId: `"+o+"` not found"),this._instancesCounts[o]-=1,this._instancesCounts[o]<1){var r=this._fromServer&&this._fromServer[o];r?(r.parentNode.removeChild(r),delete this._fromServer[o]):(this._indices[o].forEach(function(e){return t._sheet.deleteRule(e)}),delete this._indices[o]),delete this._instancesCounts[o]}},t.update=function(e,t){this.add(t),this.remove(e)},t.flush=function(){this._sheet.flush(),this._sheet.inject(),this._fromServer=void 0,this._indices={},this._instancesCounts={}},t.cssRules=function(){var e=this,t=this._fromServer?Object.keys(this._fromServer).map(function(t){return[t,e._fromServer[t]]}):[],o=this._sheet.cssRules();return t.concat(Object.keys(this._indices).map(function(t){return[t,e._indices[t].map(function(e){return o[e].cssText}).join(e._optimizeForSpeed?"":"\n")]}).filter(function(e){return!!e[1]}))},t.styles=function(e){var t,o;return t=this.cssRules(),void 0===(o=e)&&(o={}),t.map(function(e){var t=e[0],r=e[1];return a.default.createElement("style",{id:"__"+t,key:"__"+t,nonce:o.nonce?o.nonce:void 0,dangerouslySetInnerHTML:{__html:r}})})},t.getIdAndRules=function(e){var t=e.children,o=e.dynamic,r=e.id;if(o){var n=u(r,o);return{styleId:n,rules:Array.isArray(t)?t.map(function(e){return h(n,e)}):[h(n,t)]}}return{styleId:u(r),rules:Array.isArray(t)?t:[t]}},t.selectFromServer=function(){return Array.prototype.slice.call(document.querySelectorAll('[id^="__jsx-"]')).reduce(function(e,t){return e[t.id.slice(2)]=t,e},{})},e}(),f=n.createContext(null);f.displayName="StyleSheetContext";var g=a.default.useInsertionEffect||a.default.useLayoutEffect,x=new m;function _(e){var t=x||n.useContext(f);return t&&g(function(){return t.add(e),function(){t.remove(e)}},[e.id,String(e.dynamic)]),null}_.dynamic=function(e){return e.map(function(e){return u(e[0],e[1])}).join(" ")},t.style=_},645:function(e,t,o){"use strict";e.exports=o(7443).style},3336:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return f}});var r=o(5893),n=o(645),a=o.n(n),s=o(7294),l=o(1163),i=o(2920),d=o(9008),c=o.n(d),p=o(1491),u=o(610);let h=()=>(0,r.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M15 19.9201L8.47997 13.4001C7.70997 12.6301 7.70997 11.3701 8.47997 10.6001L15 4.08008",stroke:"#292D32",strokeWidth:"1.5",strokeMiterlimit:"10",strokeLinecap:"round",strokeLinejoin:"round"})}),m=()=>(0,r.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M7.42505 16.6L12.8584 11.1667C13.5 10.525 13.5 9.47502 12.8584 8.83336L7.42505 3.40002",stroke:"#292D32",strokeWidth:"1.5",strokeMiterlimit:"10",strokeLinecap:"round",strokeLinejoin:"round"})});function f(){let{user:e,loading:t}=(0,p.a)(),n=(0,l.useRouter)(),{id:d}=n.query,[f,g]=(0,s.useState)(!1),[x,_]=(0,s.useState)(null),[y,v]=(0,s.useState)({address:"Not specified",lease_duration:null,lease_duration_type:"months",deposit_amount:null,contract_start_date:null,contract_end_date:null,move_in_date:null,moveout_date:null,landlord_email:null,landlord_phone:null}),[w,b]=(0,s.useState)(null),[S,N]=(0,s.useState)(null),[j,C]=(0,s.useState)([]),[A,F]=(0,s.useState)({});(0,s.useEffect)(()=>{t||e||n.push("/welcome")},[e,t,n]),(0,s.useEffect)(()=>{d&&(async()=>{try{let t=null;try{t=(await u.E.properties.getById(d)).data,console.log("Property API response (success):",t)}catch(e){console.error("Error fetching property data from API:",e);try{console.log("Trying alternative API call for property data");let e=(await o.e(9204).then(o.bind(o,9204))).default,r=localStorage.getItem("token"),n="localhost"!==window.location.hostname;t=(await e.get("".concat(n?"https://api.depositshield.retako.com":"http://localhost:5050","/api/properties/").concat(d),{headers:r?{Authorization:"Bearer ".concat(r)}:{}})).data,console.log("Property API response (alternative):",t)}catch(t){throw console.error("Alternative API call also failed:",t),e}}if(!t){console.error("Failed to load property data"),i.Am.error("Failed to load property information");return}console.log("Property fields:",{address:t.address,description:t.description,lease_duration:t.lease_duration,lease_duration_type:t.lease_duration_type,deposit_amount:t.deposit_amount,contract_start_date:t.contract_start_date,contract_end_date:t.contract_end_date,move_in_date:t.move_in_date,landlord_email:t.landlord_email,landlord_phone:t.landlord_phone});let r={...t,contract_start_date:t.contract_start_date?new Date(t.contract_start_date).toISOString().split("T")[0]:null,contract_end_date:t.contract_end_date?new Date(t.contract_end_date).toISOString().split("T")[0]:null,move_in_date:t.move_in_date?new Date(t.move_in_date).toISOString().split("T")[0]:null};_(r);let n="property_".concat(d,"_addunit"),a=null;try{let e=localStorage.getItem(n);e&&(a=JSON.parse(e),console.log("Found stored addunit data:",a))}catch(e){console.error("Error reading from localStorage:",e)}let s={address:t.address||"Not specified",lease_duration:t.lease_duration||null,lease_duration_type:t.lease_duration_type||"months",deposit_amount:t.deposit_amount||null,contract_start_date:t.contract_start_date||null,contract_end_date:t.contract_end_date||null,move_in_date:t.move_in_date||null,landlord_email:t.landlord_email||null,landlord_phone:t.landlord_phone||null};if(a&&(!s.lease_duration&&a.leaseDuration&&(s.lease_duration=a.leaseDuration,console.log("Using stored lease duration:",s.lease_duration)),!s.lease_duration_type&&a.leaseDurationType&&(s.lease_duration_type=a.leaseDurationType,console.log("Using stored lease duration type:",s.lease_duration_type)),!s.deposit_amount&&a.depositAmount&&(s.deposit_amount=a.depositAmount,console.log("Using stored deposit amount:",s.deposit_amount)),!s.contract_start_date&&a.contractStartDate&&(s.contract_start_date=a.contractStartDate,console.log("Using stored contract start date:",s.contract_start_date)),!s.contract_end_date&&a.calculatedEndDate&&(s.contract_end_date=a.calculatedEndDate,console.log("Using stored contract end date:",s.contract_end_date)),!s.move_in_date&&a.moveInDate&&(s.move_in_date=a.moveInDate,console.log("Using stored move in date:",s.move_in_date))),console.log("Initial property details (before address handling):",s),("Not specified"===s.address||!s.address)&&t.description&&(s.address=t.description,console.log("Using description as address:",s.address)),a&&a.address&&(!s.address||"Not specified"===s.address||s.address===t.address)&&(s.address=a.address,console.log("Using stored address from addunit:",s.address)),!s.contract_end_date&&(s.contract_start_date||s.move_in_date)&&s.lease_duration){let e=s.contract_start_date||s.move_in_date;console.log("Calculating move-out date from: start=".concat(e,", duration=").concat(s.lease_duration,", type=").concat(s.lease_duration_type));let t=P(e,s.lease_duration,s.lease_duration_type);t&&(s.contract_end_date=t.toISOString().split("T")[0],console.log("Calculated move-out date: ".concat(s.contract_end_date)))}v(s),console.log("Processed property details:",s);let l="property_".concat(d),c=localStorage.getItem("".concat(l,"_user")),p=localStorage.getItem("".concat(l,"_landlord"));if(console.log("Local storage - user details:",c),console.log("Local storage - landlord details:",p),t.landlord_email||t.landlord_phone){let e={email:t.landlord_email||"",phone:t.landlord_phone||""};console.log("Using landlord details from API:",e),N(e)}else if(p)try{let e=JSON.parse(p);console.log("Parsed landlord data from localStorage:",e),N(e)}catch(e){console.error("Error parsing landlord details:",e),N({email:"",phone:""})}else N({email:"",phone:""});if(c)try{let e=JSON.parse(c);console.log("Parsed user data:",e),b(e)}catch(t){console.error("Error parsing user details:",t),b({name:(null==e?void 0:e.name)||"",email:(null==e?void 0:e.email)||"",phone:""})}else b({name:(null==e?void 0:e.name)||"",email:(null==e?void 0:e.email)||"",phone:""});try{console.log("Attempting to load photos for property from API");try{let e=await u.E.photos.getByProperty(d);if(e.data){console.log("Property photos loaded from API:",e.data);let t={};Array.isArray(e.data)?(e.data.forEach(e=>{if(e.room_id){t[e.room_id]||(t[e.room_id]={photos:[]});let o=e.url&&e.url.startsWith("/")?"".concat(u.E.getBaseUrl()).concat(e.url):e.url;t[e.room_id].photos.push({...e,url:o})}}),console.log("Processed photos by room (format 1):",t)):e.data.photosByRoom&&(Object.keys(e.data.photosByRoom).forEach(o=>{let r=e.data.photosByRoom[o];t[o]={photos:Array.isArray(r.photos)?r.photos.map(e=>({...e,url:e.url&&e.url.startsWith("/")?"".concat(u.E.getBaseUrl()).concat(e.url):e.url})):[]}}),console.log("Processed photos by room (format 2):",t)),F(t)}}catch(e){console.error("Error loading photos from API:",e)}}catch(e){console.error("Error in photos loading process:",e)}let h=localStorage.getItem("property_".concat(d,"_rooms"));console.log("Local storage - rooms:",h);let m=[];if(h)try{let e=JSON.parse(h);console.log("Parsed rooms from localStorage:",e),m=e}catch(e){console.error("Error parsing rooms from localStorage:",e)}try{console.log("Attempting to load rooms from database API");let e=await u.E.properties.getRooms(d);if(e.data&&e.data.length>0){if(console.log("Rooms loaded from database API:",e.data),m.length>0){let t={};e.data.forEach(e=>{let o=e.roomId||e.id;o&&(t[o]=e)});let o={};m.forEach(e=>{let t=e.roomId||e.id;t&&(o[t]=e)});let r=[];[...new Set([...Object.keys(t),...Object.keys(o)])].forEach(e=>{let n=t[e],a=o[e];if(n&&a){let e=n.timestamp||n.lastUpdated||"";(a.timestamp||a.lastUpdated||"")>e?r.push(a):r.push(n)}else n?r.push(n):a&&r.push(a)}),console.log("Using merged rooms from both sources:",r),C(r),localStorage.setItem("property_".concat(d,"_rooms"),JSON.stringify(r));try{console.log("Syncing merged rooms back to database"),await u.E.properties.saveRooms(d,r)}catch(e){console.error("Error syncing merged rooms to database:",e)}}else console.log("Using rooms from database API (no localStorage rooms)"),C(e.data),localStorage.setItem("property_".concat(d,"_rooms"),JSON.stringify(e.data))}else console.log("No rooms found in database API, using localStorage rooms"),C(m)}catch(e){console.log("Error loading rooms from database API:",e),console.log("Falling back to localStorage rooms"),C(m)}let f="property_".concat(d,"_room_photos"),g=localStorage.getItem(f);if(console.log("Local storage - room photos:",g?"Found":"Not found"),g)try{let e=JSON.parse(g);console.log("Parsed room photos:",e),F(e)}catch(e){console.error("Error parsing room photos:",e)}else{console.log("Attempting to load individual room photos");let e={};if(h){for(let t of JSON.parse(h)){let o=t.id,r="property_".concat(d,"_room_").concat(o,"_photos"),n=localStorage.getItem(r);if(n)try{e[o]={photos:JSON.parse(n)}}catch(e){console.error("Error parsing photos for room ".concat(o,":"),e)}}Object.keys(e).length>0&&(console.log("Combined room photos:",e),F(e))}}}catch(e){console.error("Error loading property data:",e),i.Am.error("Failed to load property details")}})()},[d,e]);let I=async()=>{g(!0);try{let t=await u.E.reports.getByProperty(d),o=t.data?t.data.filter(e=>"move-in"===e.type):[];if(0===o.length){console.log("Creating new move-in report for property:",y.address);let t={property_id:d,title:"Move-in Walkthrough for ".concat(y.address),description:"Automatically generated move-in walkthrough report",type:"move-in",address:y.address,tenant_name:(null==w?void 0:w.name)||(null==e?void 0:e.name)||"",tenant_email:(null==w?void 0:w.email)||(null==e?void 0:e.email)||"",tenant_phone:(null==w?void 0:w.phone)||"",landlord_name:"Property Owner",landlord_email:(null==S?void 0:S.email)||y.landlord_email||"",landlord_phone:(null==S?void 0:S.phone)||y.landlord_phone||"",rooms:j.map(e=>({id:e.id||e.roomId,name:e.name||e.roomName,type:e.type||e.roomType,notes:e.roomIssueNotes||e.issueNotes||[]}))},o=await u.E.reports.create(t),r=o.data.id,a=o.data.uuid;if(Object.keys(A).length>0)for(let e in console.log("Associating photos with the report"),A){let t=j.find(t=>t.id===e||t.roomId===e);if(t&&A[e]){let o=[];for(let n of(Array.isArray(A[e])?o=A[e]:A[e].photos&&Array.isArray(A[e].photos)&&(o=A[e].photos),o))if(n&&n.id)try{await u.E.photos.associateWithReport(n.id,r,{roomId:e,roomName:t.name||t.roomName})}catch(e){console.error("Error associating photo ".concat(n.id," with report:"),e)}}}if((null==S?void 0:S.email)||y.landlord_email){let e=(null==S?void 0:S.email)||y.landlord_email;console.log("Sending email notification to landlord:",e);let t={recipientEmail:e,recipientName:"Property Owner",subject:"New Move-in Walkthrough Report Shared",message:"A new move-in walkthrough report has been shared with you for property at ".concat(y.address,". You can view the report by clicking the button below."),status:"custom",reportId:r,reportUuid:a};await u.E.reports.sendNotification(r,t)}else console.log("No landlord email found to send notification");localStorage.setItem("lastSharedPropertyId",d),a&&localStorage.setItem("report_uuid",a),n.push("/reports/share-success")}else{let e=o[0];if(console.log("Using existing move-in report:",e.id),(null==S?void 0:S.email)||y.landlord_email){let t=(null==S?void 0:S.email)||y.landlord_email;console.log("Sending email notification to landlord:",t);let o={recipientEmail:t,recipientName:"Property Owner",subject:"Move-in Walkthrough Report Shared",message:"A move-in walkthrough report has been shared with you for property at ".concat(y.address,". You can view the report by clicking the button below."),status:"custom",reportId:e.id,reportUuid:e.uuid};await u.E.reports.sendNotification(e.id,o)}else console.log("No landlord email found to send notification");localStorage.setItem("lastSharedPropertyId",d),e.uuid&&localStorage.setItem("report_uuid",e.uuid),n.push("/reports/share-success")}}catch(e){console.error("Error sharing walkthrough:",e),console.error("Failed to share walkthrough. Please try again."),g(!1)}},E=e=>{console.log("Checking photos for room",e,"in",A);let t=j.find(t=>t.id===e||t.roomId===e);if(t&&t.photoCount)return console.log("Found photoCount ".concat(t.photoCount," directly in room object for ").concat(e)),t.photoCount;if(A[e]){if(Array.isArray(A[e]))return console.log("Found ".concat(A[e].length," photos for ").concat(e," in roomPhotos array")),A[e].length;if(A[e].photos&&Array.isArray(A[e].photos))return console.log("Found ".concat(A[e].photos.length," photos for ").concat(e," in roomPhotos.photos array")),A[e].photos.length;if(A[e].photoCount)return console.log("Found photoCount ".concat(A[e].photoCount," in roomPhotos object for ").concat(e)),A[e].photoCount}try{let t="property_".concat(d,"_room_").concat(e,"_photos"),o=localStorage.getItem(t);if(o){let t=JSON.parse(o);return console.log("Found ".concat(Array.isArray(t)?t.length:0," photos for ").concat(e," directly in localStorage")),Array.isArray(t)?t.length:0}}catch(t){console.error("Error getting photo count for room ".concat(e,":"),t)}return 0},k=e=>{try{if(e.notes&&Array.isArray(e.notes))return e.notes.length;if(e.roomIssueNotes){if("string"==typeof e.roomIssueNotes)return e.roomIssueNotes.split(",").filter(e=>e.trim().length>0).length;if(Array.isArray(e.roomIssueNotes))return e.roomIssueNotes.length;if("number"==typeof e.roomIssueNotes)return e.roomIssueNotes}else if(e.issueNotes){if("string"==typeof e.issueNotes)return e.issueNotes.split(",").filter(e=>e.trim().length>0).length;if(Array.isArray(e.issueNotes))return e.issueNotes.length;if("number"==typeof e.issueNotes)return e.issueNotes}else if(void 0!==e.noteCount)return e.noteCount}catch(t){console.error("Error calculating note count:",t,e)}return 0},P=(e,t,o)=>{if(!e||!t)return null;try{let r=new Date(e);if(isNaN(r.getTime()))return console.error("Invalid start date for calculation:",e),null;let n=parseInt(t,10);if(isNaN(n)||n<=0)return console.error("Invalid lease duration:",t),null;return"days"===o?r.setDate(r.getDate()+n):"weeks"===o?r.setDate(r.getDate()+7*n):"years"===o?r.setFullYear(r.getFullYear()+n):r.setMonth(r.getMonth()+n),r}catch(e){return console.error("Error calculating move-out date:",e),null}};return x&&d?(0,r.jsxs)("div",{className:"relative w-full min-h-screen bg-[#FBF5DA] font-['Nunito'] overflow-x-hidden",children:[(0,r.jsxs)(c(),{children:[(0,r.jsx)("title",{className:"jsx-5ddd0d1d61191ee8",children:"Property Summary - DepositShield"}),(0,r.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover",className:"jsx-5ddd0d1d61191ee8"}),(0,r.jsx)("meta",{name:"theme-color",content:"#FBF5DA",className:"jsx-5ddd0d1d61191ee8"}),(0,r.jsx)("meta",{name:"apple-mobile-web-app-capable",content:"yes",className:"jsx-5ddd0d1d61191ee8"}),(0,r.jsx)("meta",{name:"apple-mobile-web-app-status-bar-style",content:"default",className:"jsx-5ddd0d1d61191ee8"}),(0,r.jsx)("meta",{name:"mobile-web-app-capable",content:"yes",className:"jsx-5ddd0d1d61191ee8"}),(0,r.jsx)("meta",{name:"apple-touch-fullscreen",content:"yes",className:"jsx-5ddd0d1d61191ee8"}),(0,r.jsx)("link",{rel:"manifest",href:"/manifest.json",className:"jsx-5ddd0d1d61191ee8"}),(0,r.jsx)("link",{rel:"apple-touch-icon",href:"/icons/icon-192x192.png",className:"jsx-5ddd0d1d61191ee8"}),(0,r.jsx)("meta",{name:"format-detection",content:"telephone=no",className:"jsx-5ddd0d1d61191ee8"}),(0,r.jsx)(a(),{id:"5ddd0d1d61191ee8",children:'body{background-color:#FBF5DA;margin:0;padding:0;font-family:"Nunito",sans-serif;min-height:100vh;width:100%}.safe-area-top{padding-top:env(safe-area-inset-top,40px)}.safe-area-bottom{padding-bottom:env(safe-area-inset-bottom,20px)}@supports(padding:max(0px)){.safe-area-top{padding-top:max(env(safe-area-inset-top),40px)}.safe-area-bottom{padding-bottom:max(env(safe-area-inset-bottom),20px)}}@media screen and (-webkit-min-device-pixel-ratio:0){select,textarea,input{font-size:16px!important}}button,a{-webkit-tap-highlight-color:transparent;-ms-touch-action:-ms-manipulation;-ms-touch-action:manipulation;touch-action:manipulation}'})]}),(0,r.jsx)("div",{className:"w-full h-[40px] safe-area-top"}),(0,r.jsx)("div",{className:"fixed w-full h-[65px] left-0 top-[40px] z-10 bg-[#FBF5DA]",children:(0,r.jsxs)("div",{className:"flex flex-row justify-center items-center py-[20px] px-[10px] gap-[10px] w-full h-[65px] safe-area-inset-left safe-area-inset-right",children:[(0,r.jsx)("button",{className:"absolute left-[20px] top-[50%] transform -translate-y-1/2 p-2",onClick:()=>n.back(),"aria-label":"Go back",children:(0,r.jsx)(h,{})}),(0,r.jsx)("h1",{className:"w-full max-w-[270px] font-semibold text-[18px] leading-[140%] text-center text-[#0B1420]",children:"Property Summary"})]})}),(0,r.jsx)("div",{className:"flex flex-col items-center w-full pt-[105px] px-4 px-safe pb-[100px]",children:(0,r.jsx)("div",{className:"w-full max-w-[350px] mx-auto",children:(0,r.jsxs)("div",{className:"bg-white border border-[#D1E7D5] rounded-[16px] w-full",children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("div",{className:"flex flex-row justify-center items-center p-[0] gap-[209px] w-full h-[48px] border-b border-[#ECF0F5]",children:(0,r.jsxs)("div",{className:"flex flex-row items-center p-[0] gap-[24px] w-[318px] h-[19px] mx-4",children:[(0,r.jsx)("span",{className:"font-normal text-[14px] leading-[19px] text-[#0B1420] flex-1",children:"Tenant"}),(0,r.jsx)("span",{className:"font-bold text-[14px] leading-[19px] text-[#1C2C40] text-right flex-1",children:(null==w?void 0:w.name)||(null==e?void 0:e.name)||""})]})}),(0,r.jsx)("div",{className:"flex flex-row justify-center items-center p-[0] gap-[209px] w-full min-h-[48px] border-b border-[#ECF0F5]",children:(0,r.jsxs)("div",{className:"flex flex-row items-center p-[0] gap-[24px] w-[318px] mx-4 py-2",children:[(0,r.jsx)("span",{className:"font-normal text-[14px] leading-[19px] text-[#0B1420] min-w-[95px]",children:"Address"}),(0,r.jsx)("span",{className:"font-bold text-[14px] leading-[19px] text-[#1C2C40] text-right flex-grow",children:y.address&&"Not specified"!==y.address?y.address:"Not specified"})]})}),(0,r.jsx)("div",{className:"flex flex-row justify-center items-center p-[0] gap-[209px] w-full min-h-[48px] border-b border-[#ECF0F5]",children:(0,r.jsxs)("div",{className:"flex flex-row items-center p-[0] gap-[24px] w-[318px] mx-4 py-2",children:[(0,r.jsx)("span",{className:"font-normal text-[14px] leading-[19px] text-[#0B1420] min-w-[95px]",children:"Lease Duration"}),(0,r.jsx)("span",{className:"font-bold text-[14px] leading-[19px] text-[#1C2C40] text-right flex-grow",children:y.lease_duration&&"null"!==y.lease_duration?"".concat(y.lease_duration," ").concat(y.lease_duration_type||"months"):"Not specified"})]})}),(0,r.jsx)("div",{className:"flex flex-row justify-center items-center p-[0] gap-[209px] w-full min-h-[48px] border-b border-[#ECF0F5]",children:(0,r.jsxs)("div",{className:"flex flex-row items-center p-[0] gap-[24px] w-[318px] mx-4 py-2",children:[(0,r.jsx)("span",{className:"font-normal text-[14px] leading-[19px] text-[#0B1420] min-w-[95px]",children:"Move out Date"}),(0,r.jsx)("span",{className:"font-bold text-[14px] leading-[19px] text-[#1C2C40] text-right flex-grow",children:(e=>{if(!e)return"Not specified";try{let t=new Date(e);if(isNaN(t.getTime()))return console.error("Invalid date:",e),"Not specified";return t.toLocaleDateString("en-US",{day:"2-digit",month:"2-digit",year:"numeric"}).replace(/\//g,".")}catch(e){return console.error("Error formatting date:",e),"Not specified"}})(y.contract_end_date)})]})}),(0,r.jsx)("div",{className:"flex flex-row justify-center items-center p-[0] gap-[209px] w-full min-h-[48px] border-b border-[#ECF0F5]",children:(0,r.jsxs)("div",{className:"flex flex-row items-center p-[0] gap-[24px] w-[318px] mx-4 py-2",children:[(0,r.jsx)("span",{className:"font-normal text-[14px] leading-[19px] text-[#0B1420] min-w-[95px]",children:"Deposit Amount"}),(0,r.jsx)("span",{className:"font-bold text-[14px] leading-[19px] text-[#1C2C40] text-right flex-grow",children:y.deposit_amount&&"null"!==y.deposit_amount?(e=>{if(!e&&0!==e)return"Not specified";try{let t=parseFloat(e);if(isNaN(t))return console.error("Invalid currency amount:",e),"Not specified";return"$".concat(t.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,","))}catch(e){return console.error("Error formatting currency:",e),"Not specified"}})(y.deposit_amount):"Not specified"})]})}),(0,r.jsx)("div",{className:"flex flex-row justify-center items-center p-[0] gap-[209px] w-full h-[48px] border-b border-[#ECF0F5]",children:(0,r.jsxs)("div",{className:"flex flex-row items-center p-[0] gap-[24px] w-[318px] h-[19px] mx-4",children:[(0,r.jsx)("span",{className:"font-normal text-[14px] leading-[19px] text-[#0B1420] flex-1",children:"Landlord Mail"}),(0,r.jsx)("span",{className:"font-bold text-[14px] leading-[19px] text-[#1C2C40] text-right flex-1",children:y.landlord_email||(null==S?void 0:S.email)||"Not provided"})]})}),(0,r.jsx)("div",{className:"flex flex-row justify-center items-center p-[0] gap-[209px] w-full h-[48px] border-b border-[#ECF0F5]",children:(0,r.jsxs)("div",{className:"flex flex-row items-center p-[0] gap-[24px] w-[318px] h-[19px] mx-4",children:[(0,r.jsx)("span",{className:"font-normal text-[14px] leading-[19px] text-[#0B1420] flex-1",children:"Landlord Phone"}),(0,r.jsx)("span",{className:"font-bold text-[14px] leading-[19px] text-[#1C2C40] text-right flex-1",children:y.landlord_phone||(null==S?void 0:S.phone)||"Not provided"})]})})]}),j.length>0&&j.map((e,t)=>{let o=e.id||e.roomId||"room_".concat(t),n=e.name||e.roomName||e.type||e.roomType||"Room ".concat(t+1);return(0,r.jsxs)("div",{className:"flex flex-row justify-between items-start px-4 py-3 border-b border-[#ECF0F5] last:border-b-0",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsxs)("div",{className:"flex flex-row items-center gap-1",children:[(0,r.jsx)("span",{className:"font-bold text-[14px] leading-[19px] text-[#0B1420]",children:n}),k(e)>0&&(0,r.jsxs)("span",{className:"font-semibold text-[14px] leading-[19px] text-[#515964]",children:["(",k(e)," ",1===k(e)?"item":"items"," noted)"]}),0===k(e)&&(0,r.jsx)("span",{className:"font-semibold text-[14px] leading-[19px] text-[#515964]",children:"(No Notes)"})]}),E(o)>0&&(0,r.jsxs)("div",{className:"flex flex-row items-center gap-1",children:[(0,r.jsx)("div",{className:"relative w-[60px] h-[24px]",children:[...Array(Math.min(4,E(o)||0))].map((e,t)=>{let n=null;try{var a,s,l,i,c;if(null===(l=A[o])||void 0===l?void 0:null===(s=l.photos)||void 0===s?void 0:null===(a=s[t])||void 0===a?void 0:a.url){if((n=A[o].photos[t].url)&&n.startsWith("/")){let e="localhost"!==window.location.hostname;n="".concat(e?"https://api.depositshield.retako.com":"http://localhost:5050").concat(n),console.log("Generated full URL for room photo: ".concat(n))}}else if(null===(c=A[o])||void 0===c?void 0:null===(i=c.photos)||void 0===i?void 0:i[t]){if(n=A[o].photos[t],"string"==typeof n&&n.startsWith("/")){let e="localhost"!==window.location.hostname;n="".concat(e?"https://api.depositshield.retako.com":"http://localhost:5050").concat(n),console.log("Generated full URL for room photo: ".concat(n))}}else{let e="property_".concat(d,"_room_").concat(o,"_photos"),r=localStorage.getItem(e);if(r)try{let e=JSON.parse(r);if(e&&e.length>t){let o=e[t];if((n="string"==typeof o?o:(null==o?void 0:o.url)||null)&&"string"==typeof n&&n.startsWith("/")){let e="localhost"!==window.location.hostname;n="".concat(e?"https://api.depositshield.retako.com":"http://localhost:5050").concat(n),console.log("Generated full URL for room photo from localStorage: ".concat(n))}}}catch(e){console.error("Error parsing photo data for room ".concat(o,":"),e)}}}catch(e){console.error("Error getting photo URL for room ".concat(o,":"),e)}return console.log("Photo URL for room ".concat(o,", index ").concat(t,": ").concat(n||"None")),(0,r.jsxs)("div",{className:"absolute top-0 w-[24px] h-[24px] bg-gray-200 border border-[#D1E7E2] rounded-full overflow-hidden",style:{left:"".concat(12*t,"px"),backgroundImage:n?"url(".concat(n,")"):"none",backgroundSize:"cover",backgroundPosition:"center",zIndex:10-t},children:[!n&&(0,r.jsx)("div",{className:"flex items-center justify-center w-full h-full bg-gray-200",children:(0,r.jsxs)("svg",{width:"12",height:"12",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("path",{d:"M6 8C7.10457 8 8 7.10457 8 6C8 4.89543 7.10457 4 6 4C4.89543 4 4 4.89543 4 6C4 7.10457 4.89543 8 6 8Z",fill:"#A3ADB8"}),(0,r.jsx)("path",{d:"M9.33333 2H6.66667C3.33333 2 2 3.33333 2 6.66667V9.33333C2 12.6667 3.33333 14 6.66667 14H9.33333C12.6667 14 14 12.6667 14 9.33333V6.66667C14 3.33333 12.6667 2 9.33333 2ZM12.3067 9.63333L10.2867 7.22C10.08 6.96667 9.82667 6.96667 9.62 7.22L7.88667 9.3C7.68667 9.55 7.43333 9.55 7.23333 9.3L6.65333 8.58C6.45333 8.33667 6.20667 8.34333 6.01333 8.59333L3.81333 11.4767C3.57333 11.7933 3.69333 12.06 4.10667 12.06H11.8867C12.3 12.06 12.4267 11.7933 12.3067 9.63333Z",fill:"#A3ADB8"})]})}),E(o)>4&&3===t?(0,r.jsxs)("div",{className:"flex items-center justify-center w-full h-full bg-[#1C2C40] text-white text-[10px] font-bold",children:["+",E(o)-3]}):null]},t)})}),(0,r.jsxs)("span",{className:"font-semibold text-[12px] leading-[16px] text-[#515964]",children:["(",E(o)," ",1===E(o)?"Photo":"Photos",")"]})]})]}),(0,r.jsx)(m,{})]},o||t)})]})})}),(0,r.jsx)("div",{className:"fixed bottom-0 left-0 right-0 w-full px-5 py-4 bg-[#FBF5DA] pb-safe pt-4 shadow-inner",children:(0,r.jsx)("div",{className:"w-[90%] max-w-[350px] mx-auto",children:(0,r.jsx)("button",{onClick:I,disabled:f,className:"w-full h-[56px] flex flex-row justify-center items-center px-4 py-[18px] gap-[10px] bg-[#1C2C40] rounded-[16px] touch-manipulation active:bg-[#283c56] transition-colors",children:(0,r.jsx)("span",{className:"font-bold text-[16px] leading-[22px] text-[#D1E7E2]",children:f?"Sharing...":"Share Walkthrough"})})})})]}):(0,r.jsx)("div",{className:"flex justify-center items-center h-screen bg-[#FBF5DA]",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#1C2C40]"})})}},1479:function(){}},function(e){e.O(0,[2888,9774,179],function(){return e(e.s=4885)}),_N_E=e.O()}]);