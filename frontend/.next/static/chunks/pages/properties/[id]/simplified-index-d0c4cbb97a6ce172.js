(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1369],{3318:function(e,l,o){(window.__NEXT_P=window.__NEXT_P||[]).push(["/properties/[id]/simplified-index",function(){return o(2815)}])},2815:function(e,l,o){"use strict";o.r(l),o.d(l,{default:function(){return c}});var a=o(5893),t=o(7294),r=o(1163);o(1664),o(9008);var s=o(2920),i=o(6153),n=o(610),d=o(1491);function c(){let{user:e,loading:l}=(0,d.a)(),[o,c]=(0,t.useState)(null),[h,m]=(0,t.useState)({}),[u,g]=(0,t.useState)([]),[p,x]=(0,t.useState)(!0),y=(0,r.useRouter)(),{id:f}=y.query;(0,t.useEffect)(()=>{if(!l&&!e){y.push("/login");return}f&&(b(),j())},[f,e,l,y]);let b=async()=>{try{console.log("M\xfclk bilgileri getiriliyor:",f);let e=await n.E.properties.getById(f);console.log("M\xfclk bilgileri:",e.data),c(e.data)}catch(e){console.error("M\xfclk bilgileri getirilemedi:",e),s.Am.error("M\xfclk bilgileri y\xfcklenirken bir hata oluştu")}finally{x(!1)}},j=async()=>{try{console.log("Fotoğraflar getiriliyor:",f);let e=await n.E.photos.getByProperty(f);if(console.log("Fotoğraf yanıtı:",e.data),e.data&&e.data.photosByRoom){let l=e.data.photosByRoom;console.log("Oda bazında fotoğraflar:",l),m(l);let o=[];Object.keys(l).forEach(e=>{let a=l[e],t=a&&a.photos?a.photos:[];if(t.length>0){let l="Oda "+e.split("_").pop().substring(0,3);o.push({id:e,name:l,type:"other",photoCount:t.length,roomQuality:null,itemsNoted:0})}}),console.log("Oluşturulan odalar:",o),o.length>0?g(o):await N()}else console.log("Fotoğraflar bulunamadı veya yanlış formatta"),await N()}catch(e){console.error("Fotoğraflar getirilemedi:",e),await N()}},N=async()=>{try{console.log("API'den odalar getiriliyor");let e=await n.E.properties.getRooms(f);if(console.log("API oda yanıtı:",e.data),e.data&&Array.isArray(e.data)&&e.data.length>0){let l=e.data.map(e=>({id:e.roomId||e.id,name:e.roomName||e.name||"İsimsiz Oda",type:e.roomType||e.type||"other",photoCount:parseInt(e.photoCount)||0,roomQuality:e.roomQuality?String(e.roomQuality):null,itemsNoted:0}));console.log("API'den gelen odalar:",l),g(l)}else console.log("API'de oda bulunamadı"),g([])}catch(e){console.error("API'den odalar getirilemedi:",e),g([])}};return p||l?(0,a.jsx)(i.Z,{children:(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"M\xfclk Y\xfckleniyor..."})})}):o?(0,a.jsx)(i.Z,{children:(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:o.address}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md mb-8",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold mb-4",children:["Odalar (",u.length,")"]}),u.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:u.map(e=>(0,a.jsxs)("div",{className:"border p-4 rounded-lg hover:bg-gray-50 cursor-pointer",onClick:()=>y.push("/properties/".concat(f,"/configure-room?roomId=").concat(e.id)),children:[(0,a.jsx)("h3",{className:"font-bold text-lg",children:e.name}),(0,a.jsxs)("div",{className:"text-gray-600 mb-2",children:["Fotoğraf sayısı: ",e.photoCount]}),(0,a.jsx)("div",{className:"flex flex-wrap",children:h[e.id]&&h[e.id].photos?h[e.id].photos.slice(0,3).map((e,l)=>(0,a.jsx)("div",{className:"w-16 h-16 mr-2 mb-2 bg-gray-200 relative overflow-hidden",children:(0,a.jsx)("img",{src:e.url&&e.url.startsWith("/uploads/")?"".concat(n.E.getBaseUrl()).concat(e.url):e.url,alt:"Oda fotoğrafı ".concat(l+1),className:"w-full h-full object-cover"})},l)):(0,a.jsx)("div",{className:"text-gray-500",children:"Fotoğraf \xf6nizlemesi yok"})})]},e.id))}):(0,a.jsxs)("div",{className:"text-center p-8 bg-gray-100 rounded-lg",children:[(0,a.jsx)("p",{className:"text-gray-600",children:"Bu m\xfclkte hen\xfcz oda ekli değil"}),(0,a.jsx)("button",{className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded-lg",onClick:()=>y.push("/properties/".concat(f,"/configure-room")),children:"Oda Ekle"})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"M\xfclk Detayları"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-bold",children:"Adres"}),(0,a.jsx)("p",{children:o.address})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-bold",children:"A\xe7ıklama"}),(0,a.jsx)("p",{children:o.description||"A\xe7ıklama yok"})]})]})]})]})}):(0,a.jsx)(i.Z,{children:(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"M\xfclk Bulunamadı"})})})}}},function(e){e.O(0,[1664,6153,2888,9774,179],function(){return e(e.s=3318)}),_N_E=e.O()}]);