(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4772],{7599:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/email-verification",function(){return s(6303)}])},6303:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return r}});var l=s(5893),n=s(7294),i=s(1163),o=s(9008),a=s.n(o);s(1664);var c=s(1491);function r(){let[e,t]=(0,n.useState)(["","","",""]),[s,o]=(0,n.useState)(""),[r,d]=(0,n.useState)(""),[x,u]=(0,n.useState)(!1),[m,f]=(0,n.useState)(!1),[p,h]=(0,n.useState)(null),[g,b]=(0,n.useState)(180),j=(0,i.useRouter)(),{verifyEmail:w,resendVerificationCode:v}=(0,c.a)();(0,n.useEffect)(()=>{j.isReady&&(j.query.email&&o(j.query.email),j.query.userId&&d(j.query.userId))},[j.isReady,j.query]),(0,n.useEffect)(()=>{document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light")},[]),(0,n.useEffect)(()=>{console.log("Code updated:",e.join(""))},[e]),(0,n.useEffect)(()=>{let e=g>0&&setInterval(()=>b(g-1),1e3);return()=>clearInterval(e)},[g]);let y=(s,l)=>{if(f(!1),l.length>1){let n=l.split("").slice(0,4),i=[...e];n.forEach((e,t)=>{s+t<4&&(i[s+t]=e)}),t(i);let o=i.findIndex(e=>!e);-1!==o&&o<4&&setTimeout(()=>{let e=document.getElementById("code-".concat(o));e&&(e.focus(),h(o))},10)}else{let n=[...e];n[s]=l,t(n),l&&s<3&&setTimeout(()=>{let e=document.getElementById("code-".concat(s+1));e&&(e.focus(),h(s+1))},10)}},N=async()=>{let t=e.join("");u(!0),f(!1);try{console.log("Submitting verification with:",{userId:r,code:t});let e=await w(r,t);console.log("Verification result:",e),e&&e.success?(localStorage.setItem("newlyVerified","true"),j.push("/verification-success")):(console.error("Verification failed:",e),f(!0))}catch(e){console.error("Verification error:",e),f(!0)}finally{u(!1)}},E=async()=>{if(!(g>0)){f(!1);try{if(!r){console.error("User ID is missing. Please try again or go back to login.");return}let e=await v(r);e.success?(t(["","","",""]),b(180),setTimeout(()=>{let e=document.getElementById("code-0");e&&e.focus()},100)):console.error(e.message||"Failed to resend verification code. Please try again.")}catch(e){console.error("Error resending code:",e)}}};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(a(),{children:[(0,l.jsx)("title",{children:"Verify Your Email - DepositShield"}),(0,l.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"}),(0,l.jsx)("meta",{name:"theme-color",content:"#4F46E5"})]}),(0,l.jsxs)("div",{className:"relative min-h-screen w-full font-['Nunito'] bg-[#FBF5DA]",style:{maxWidth:"100%",margin:"0 auto"},children:[(0,l.jsx)("div",{className:"h-10 w-full"}),(0,l.jsx)("div",{className:"w-full h-[65px] flex items-center justify-center p-5 bg-[#FBF5DA]",children:(0,l.jsx)("h1",{className:"font-semibold text-[18px] text-center text-[#0B1420]",children:"Verify Your Email"})}),(0,l.jsxs)("div",{className:"flex flex-col items-center p-6 gap-6 mt-4",children:[(0,l.jsx)("div",{className:"relative h-[180px] w-[180px] flex items-center justify-center",children:(0,l.jsx)("div",{className:"absolute w-[180px] h-[180px] bg-white rounded-full shadow-sm overflow-hidden",children:(0,l.jsx)("img",{src:"/images/email-verification.png",alt:"Email verification",className:"absolute w[200px] h[100px] left[15px] top-[0px] transform rotate-[0deg]"})})}),(0,l.jsxs)("div",{className:"flex flex-col items-center gap-3 max-w-[320px]",children:[(0,l.jsx)("h2",{className:"font-bold text-[18px] text-center text-[#0B1420] whitespace-nowrap",children:"Let's confirm it's you"}),(0,l.jsxs)("div",{className:"font-semibold text-[13px] text-center text-[#515964]",children:[(0,l.jsx)("p",{className:"mb-1",children:"Enter the 4-digit code we sent to:"}),(0,l.jsx)("p",{className:"font-semibold",children:s})]})]}),(0,l.jsx)("div",{className:"flex flex-col items-center w-full mt-4",children:(0,l.jsxs)("div",{className:"flex flex-col items-center w-full",children:[(0,l.jsx)("div",{className:"flex justify-center gap-4 w-full",children:[0,1,2,3].map(t=>(0,l.jsxs)("div",{className:"box-border w-[60px] h-[56px] bg-white border rounded-[16px] relative transition-colors duration-200 ".concat(p===t?"border-[#55A363] bg-[#F6FEF7]":"border-[#D1E7D5]"),children:[e[t]&&(0,l.jsx)("span",{className:"absolute w-full text-center top-[16px] font-bold text-[14px] text-[#0B1420]",children:e[t]}),(0,l.jsx)("input",{id:"code-".concat(t),type:"text",inputMode:"numeric",maxLength:"1",value:e[t],onChange:e=>y(t,e.target.value.replace(/[^0-9]/g,"")),onFocus:()=>h(t),onBlur:()=>h(null),className:"w-full h-full text-center text-[14px] font-bold bg-transparent outline-none ".concat(e[t]?"text-[#0B1420] opacity-0":"text-[#0B1420]"),style:{backgroundColor:"transparent",borderColor:p===t?"#55A363":"#D1E7D5",borderRadius:"16px",border:p===t?"1px solid #55A363":"1px solid #D1E7D5"},autoFocus:0===t&&!e[0]})]},t))}),m&&(0,l.jsx)("p",{className:"font-bold text-[14px] text-center text-[#E95858] mt-4",children:"Hmm, that code isn't right."})]})}),(0,l.jsxs)("button",{className:"w-full py-2 font-normal text-[14px] text-center text-[#1C2C40] mt-2",onClick:E,disabled:g>0,children:["Didn't get the code? ",(0,l.jsx)("span",{className:"font-semibold ".concat(g>0?"text-[#8A9099]":"text-[#4D935A]"),children:g>0?"Resend in ".concat(g,"s"):"Resend it"})]})]}),(0,l.jsx)("div",{className:"w-full flex justify-center fixed bottom-8",children:(0,l.jsx)("button",{onClick:N,disabled:x||e.some(e=>""===e),className:"w-[90%] max-w-[350px] h-[56px] flex justify-center items-center py-4 bg-[#1C2C40] rounded-[16px] disabled:opacity-50",children:(0,l.jsx)("span",{className:"font-bold text-[16px] text-[#D1E7E2]",children:x?"Processing...":"Confirm"})})}),(0,l.jsx)("div",{className:"pb-[50px]"})]})]})}}},function(e){e.O(0,[1664,2888,9774,179],function(){return e(e.s=7599)}),_N_E=e.O()}]);