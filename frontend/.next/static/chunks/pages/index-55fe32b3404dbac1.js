(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5405],{5557:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(9828)}])},9828:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return w}});var s=a(5893),o=a(645),r=a.n(o),i=a(7294),n=a(1163),l=a(1664),c=a.n(l),d=a(9008),p=a.n(d),x=a(2920),m=a(1491);a(610);var f=a(3114),h=a(1726);let u=()=>(0,s.jsxs)("svg",{width:"22",height:"22",viewBox:"0 0 22 22",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("rect",{x:"2",y:"5",width:"18",height:"2",rx:"1",fill:"#1C2C40"}),(0,s.jsx)("rect",{x:"2",y:"10",width:"18",height:"2",rx:"1",fill:"#1C2C40"}),(0,s.jsx)("rect",{x:"2",y:"15",width:"18",height:"2",rx:"1",fill:"#1C2C40"})]});function w(){let{user:e,loading:t}=(0,m.a)(),o=(0,n.useRouter)(),[l,d]=(0,i.useState)({properties:0,reports:0}),[w,g]=(0,i.useState)([]),[y,b]=(0,i.useState)([]),[j,v]=(0,i.useState)(!1),[k,N]=(0,i.useState)(!1),C=(0,i.useRef)(null),z=(0,i.useRef)(null);(0,i.useEffect)(()=>{t||e?e&&("true"===localStorage.getItem("newlyVerified")?(localStorage.removeItem("newlyVerified"),o.push("/onboarding")):v(!1)):o.push("/welcome")},[e,t,o]),(0,i.useEffect)(()=>{function e(e){z.current&&!z.current.contains(e.target)&&k&&N(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[z,k]);let E=()=>{v(!1)};(0,i.useEffect)(()=>{e&&F()},[e]),(0,i.useEffect)(()=>{if(!t&&0===y.length&&0===l.properties&&e){var a,s,o,r;null===(s=window.performance)||void 0===s||null===(a=s.navigation)||void 0===a||a.type,null===(r=window.performance)||void 0===r||null===(o=r.navigation)||void 0===o||o.TYPE_NAVIGATE,console.log("Properties length:",y.length),console.log("Stats properties:",l.properties)}},[t,y,l.properties,e,o]);let L=async(e,t)=>{if(e.stopPropagation(),confirm("Bu m\xfclk\xfc silmek istediğinizden emin misiniz? Bu işlem geri alınamaz."))try{let e=localStorage.getItem("token");if(!e){x.Am.error("Oturum doğrulanmadı");return}let s="localhost"!==window.location.hostname;try{let o=(await a.e(9204).then(a.bind(a,9204))).default;await o.delete("".concat(s?"https://api.depositshield.retako.com":"http://localhost:5050","/api/properties/").concat(t),{headers:{Authorization:"Bearer ".concat(e)}}),b(y.filter(e=>e.id!==t)),d(e=>({...e,properties:e.properties-1})),x.Am.success("M\xfclk başarıyla silindi")}catch(e){console.error("API silme hatası:",e),b(y.filter(e=>e.id!==t)),x.Am.success("M\xfclk yerel olarak silindi")}}catch(e){console.error("M\xfclk silme hatası:",e),x.Am.error("M\xfclk silinirken bir hata oluştu")}},F=async()=>{try{console.log("Fetching dashboard data...");let e=(await a.e(9204).then(a.bind(a,9204))).default,t=localStorage.getItem("token"),s={"Content-Type":"application/json",Accept:"application/json"};t&&(s.Authorization="Bearer ".concat(t));let o="localhost"!==window.location.hostname?"https://api.depositshield.retako.com":"http://localhost:5050";console.log("Using API URL:",o);let r=[];try{console.log("Fetching properties from","".concat(o,"/api/properties")),r=(await e.get("".concat(o,"/api/properties"),{headers:s})).data||[],console.log("Loaded ".concat(r.length," properties")),b(r)}catch(e){console.error("Failed to load properties:",e),r=[]}let i=[];try{console.log("Fetching reports from","".concat(o,"/api/reports")),i=(await e.get("".concat(o,"/api/reports"),{headers:s})).data||[],console.log("Loaded ".concat(i.length," reports"))}catch(e){console.error("Failed to load reports:",e),i=[]}d({properties:r.length,reports:i.length});try{let e=[];i&&i.length>0&&(i.sort((e,t)=>new Date(t.created_at||0)-new Date(e.created_at||0)),e.push({id:"report-".concat(i[0].id||1),type:"create_report",title:"Created new report",description:i[0].title?"".concat(i[0].type||"Report",": ").concat(i[0].title):"Property Report",time:"2 hours ago",icon:"report"})),r&&r.length>0&&e.push({id:"property-".concat(r[0].id||2),type:"add_property",title:"Added new property",description:r[0].address||"Property Address",time:"3 days ago",icon:"property"}),0===e.length&&e.push({id:"welcome-1",type:"system",title:"System Message",description:"Welcome to DepositShield",time:"Just now",icon:"report"}),g(e),console.log("Recent activities created:",e.length)}catch(e){console.error("Error creating activities:",e),g([{id:"fallback-1",type:"system",title:"System Message",description:"Welcome to DepositShield",time:"Just now",icon:"report"}])}}catch(e){console.error("Error fetching dashboard data:",e)}};return t?(0,s.jsx)("div",{className:"flex justify-center items-center h-screen bg-[#FBF5DA]",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#1C2C40]"})}):e?(0,s.jsxs)("div",{className:"flex flex-col items-center bg-[#FBF5DA] font-['Nunito'] min-h-screen relative overflow-hidden",children:[(0,s.jsxs)(p(),{children:[(0,s.jsx)("title",{className:"jsx-fdba926a17c3def7",children:"DepositShield - My Home"}),(0,s.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no",className:"jsx-fdba926a17c3def7"}),(0,s.jsx)("meta",{name:"theme-color",content:"#FBF5DA",className:"jsx-fdba926a17c3def7"}),(0,s.jsx)("meta",{name:"apple-mobile-web-app-capable",content:"yes",className:"jsx-fdba926a17c3def7"}),(0,s.jsx)("meta",{name:"apple-mobile-web-app-status-bar-style",content:"default",className:"jsx-fdba926a17c3def7"}),(0,s.jsx)(r(),{id:"fdba926a17c3def7",children:'body{background-color:#FBF5DA;margin:0;padding:0;min-height:100vh;width:100%;font-family:"Nunito",sans-serif}.safe-area-top{padding-top:env(safe-area-inset-top,40px)}.safe-area-bottom{padding-bottom:env(safe-area-inset-bottom,20px)}@-webkit-keyframes slideIn{from{-webkit-transform:translatex(-100%);transform:translatex(-100%);opacity:0}to{-webkit-transform:translatex(0);transform:translatex(0);opacity:1}}@-moz-keyframes slideIn{from{-moz-transform:translatex(-100%);transform:translatex(-100%);opacity:0}to{-moz-transform:translatex(0);transform:translatex(0);opacity:1}}@-o-keyframes slideIn{from{-o-transform:translatex(-100%);transform:translatex(-100%);opacity:0}to{-o-transform:translatex(0);transform:translatex(0);opacity:1}}@keyframes slideIn{from{-webkit-transform:translatex(-100%);-moz-transform:translatex(-100%);-o-transform:translatex(-100%);transform:translatex(-100%);opacity:0}to{-webkit-transform:translatex(0);-moz-transform:translatex(0);-o-transform:translatex(0);transform:translatex(0);opacity:1}}.animate-slideIn{-webkit-animation:slideIn.4s cubic-bezier(.16,1,.3,1)forwards;-moz-animation:slideIn.4s cubic-bezier(.16,1,.3,1)forwards;-o-animation:slideIn.4s cubic-bezier(.16,1,.3,1)forwards;animation:slideIn.4s cubic-bezier(.16,1,.3,1)forwards}.side-menu-backdrop{background-color:rgba(0,0,0,.4);position:fixed;top:0;left:0;width:100%;height:100%;z-index:30;-webkit-transition:opacity.4s;-moz-transition:opacity.4s;-o-transition:opacity.4s;transition:opacity.4s;opacity:0;-webkit-animation:fadeIn.4s forwards;-moz-animation:fadeIn.4s forwards;-o-animation:fadeIn.4s forwards;animation:fadeIn.4s forwards}@-webkit-keyframes fadeIn{from{opacity:0}to{opacity:1}}@-moz-keyframes fadeIn{from{opacity:0}to{opacity:1}}@-o-keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@-webkit-keyframes fadeOut{from{opacity:1}to{opacity:0}}@-moz-keyframes fadeOut{from{opacity:1}to{opacity:0}}@-o-keyframes fadeOut{from{opacity:1}to{opacity:0}}@keyframes fadeOut{from{opacity:1}to{opacity:0}}@-webkit-keyframes slideOut{from{-webkit-transform:translatex(0);transform:translatex(0);opacity:1}to{-webkit-transform:translatex(-100%);transform:translatex(-100%);opacity:0}}@-moz-keyframes slideOut{from{-moz-transform:translatex(0);transform:translatex(0);opacity:1}to{-moz-transform:translatex(-100%);transform:translatex(-100%);opacity:0}}@-o-keyframes slideOut{from{-o-transform:translatex(0);transform:translatex(0);opacity:1}to{-o-transform:translatex(-100%);transform:translatex(-100%);opacity:0}}@keyframes slideOut{from{-webkit-transform:translatex(0);-moz-transform:translatex(0);-o-transform:translatex(0);transform:translatex(0);opacity:1}to{-webkit-transform:translatex(-100%);-moz-transform:translatex(-100%);-o-transform:translatex(-100%);transform:translatex(-100%);opacity:0}}.animate-slideOut{-webkit-animation:slideOut.3s cubic-bezier(.4,0,.2,1)forwards;-moz-animation:slideOut.3s cubic-bezier(.4,0,.2,1)forwards;-o-animation:slideOut.3s cubic-bezier(.4,0,.2,1)forwards;animation:slideOut.3s cubic-bezier(.4,0,.2,1)forwards}'})]}),(0,s.jsx)(f.M,{children:j&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3,ease:"easeInOut"},className:"side-menu-backdrop",onClick:E}),(0,s.jsxs)(h.E.div,{ref:C,initial:{x:"-100%"},animate:{x:0},exit:{x:"-100%"},transition:{type:"spring",stiffness:400,damping:40,duration:.5},className:"fixed top-0 left-0 h-full w-[280px] bg-[#F5F6F8] z-40",style:{borderRadius:"0px",position:"fixed",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)"},children:[(0,s.jsx)("div",{className:"w-full h-[65px] mt-[20px]",children:(0,s.jsxs)("div",{className:"flex flex-row justify-center items-center p-[16px] w-full h-[65px] relative",children:[(0,s.jsx)("button",{className:"absolute w-[32px] h-[32px] left-[16px] top-[50%] transform -translate-y-1/2 p-1 bg-gray-100 rounded-full flex items-center justify-center",onClick:E,"aria-label":"Go back",children:(0,s.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M15 19L8 12L15 5",stroke:"#2E3642",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,s.jsx)("h1",{className:"font-semibold text-[18px] leading-[25px] text-center text-[#0B1420]",children:"Menu"})]})}),(0,s.jsxs)("div",{className:"w-full flex flex-col items-center p-[16px] mt-[10px]",children:[(0,s.jsxs)("div",{className:"w-full h-[64px] mb-0 relative",children:[(0,s.jsxs)("div",{className:"flex flex-row items-center p-[12px_0px] gap-[16px] w-full h-[64px]",children:[(0,s.jsx)("div",{className:"w-[40px] h-[40px] flex items-center justify-center rounded-[225px]",children:(0,s.jsx)("img",{src:"/images/iconss/moveout.png",alt:"Move out",className:"w-[40px] h-[40px]"})}),(0,s.jsx)(c(),{href:"/move-out",className:"font-['Nunito'] font-semibold text-[16px] leading-[22px] text-[#111519]",children:"Move out"})]}),(0,s.jsx)("div",{className:"w-full h-0 border-b border-[#ECF0F5]"})]}),(0,s.jsxs)("div",{className:"w-full h-[64px] mb-0 relative",children:[(0,s.jsxs)("div",{className:"flex flex-row items-center p-[12px_0px] gap-[16px] w-full h-[64px]",children:[(0,s.jsx)("div",{className:"w-[40px] h-[40px] flex items-center justify-center rounded-[225px]",children:(0,s.jsx)("img",{src:"/images/iconss/passwordchange.png",alt:"Password Change",className:"w-[40px] h-[40px]"})}),(0,s.jsx)(c(),{href:"/profile/change-password",className:"font-['Nunito'] font-semibold text-[16px] leading-[22px] text-[#111519]",children:"Password Change"})]}),(0,s.jsx)("div",{className:"w-full h-0 border-b border-[#ECF0F5]"})]}),(0,s.jsxs)("div",{className:"w-full h-[64px] mb-0 relative",children:[(0,s.jsxs)("div",{className:"flex flex-row items-center p-[12px_0px] gap-[16px] w-full h-[64px]",children:[(0,s.jsx)("div",{className:"w-[40px] h-[40px] flex items-center justify-center rounded-[225px]",children:(0,s.jsx)("img",{src:"/images/iconss/24support.png",alt:"Support",className:"w-[22px] h-[22px]"})}),(0,s.jsx)("button",{onClick:()=>console.log("Support functionality not yet implemented"),className:"font-['Nunito'] font-semibold text-[16px] leading-[22px] text-[#111519] text-left",children:"Support"})]}),(0,s.jsx)("div",{className:"w-full h-0 border-b border-[#ECF0F5]"})]}),(0,s.jsx)("div",{className:"w-full h-[64px] mb-0 relative",children:(0,s.jsxs)("div",{className:"flex flex-row items-center p-[12px_0px] gap-[16px] w-full h-[64px]",children:[(0,s.jsx)("div",{className:"w-[40px] h-[40px] flex items-center justify-center rounded-[225px]",children:(0,s.jsx)("img",{src:"/images/iconss/logout.png",alt:"Logout",className:"w-[22px] h-[22px]"})}),(0,s.jsx)("button",{onClick:()=>{localStorage.removeItem("token"),o.push("/login")},className:"font-['Nunito'] font-semibold text-[16px] leading-[22px] text-[#111519] text-left",children:"Log out"})]})})]})]})]})}),(0,s.jsxs)("div",{className:"w-full max-w-[390px] relative",children:[(0,s.jsx)("div",{className:"h-[40px] w-full safe-area-top"}),(0,s.jsx)("div",{className:"w-full h-[65px]",children:(0,s.jsxs)("div",{className:"flex flex-row justify-center items-center px-[10px] py-[20px] w-full h-[65px] relative",children:[(0,s.jsx)("button",{className:"absolute left-[20px] top-[50%] transform -translate-y-1/2 z-10",onClick:()=>v(!0),"aria-label":"Open menu",children:(0,s.jsx)(u,{})}),(0,s.jsx)("h1",{className:"font-semibold text-[18px] leading-[25px] text-center text-[#0B1420]",children:"My Home"})]})}),(0,s.jsx)("div",{className:"w-full px-4",children:0===y.length?(0,s.jsxs)("div",{className:"w-full flex flex-col justify-end items-center gap-[20px] mb-8",children:[(0,s.jsx)("div",{className:"w-[248.82px] h-[135.29px] mt-[10px]",children:(0,s.jsx)("img",{src:"/images/dashboard.png",alt:"Home illustration",className:"w-full h-full object-contain",style:{mixBlendMode:"Luminosity"},loading:"eager"})}),(0,s.jsx)("p",{className:"w-full max-w-[311px] font-bold text-[16px] leading-[22px] text-center text-[#515964]",children:"Add the place you're renting so we can help protect your deposit."})]}):(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)("h2",{className:"font-bold text-[16px] leading-[22px] text-[#0B1420] mb-4",children:"Your Properties"}),(0,s.jsx)("div",{className:"flex flex-col gap-[10px] w-full mb-6",children:y.map(e=>(0,s.jsxs)("div",{className:"w-full p-[16px] bg-white border border-[#D1E7D5] rounded-[16px] cursor-pointer relative active:bg-gray-50 transition-colors touch-manipulation",onClick:()=>o.push("/properties/details?propertyId=".concat(e.id)),children:[(0,s.jsx)("button",{className:"absolute bottom-[8px] right-[8px] w-[32px] h-[32px] flex items-center justify-center z-10 opacity-80 hover:opacity-100 active:opacity-100 transition-opacity touch-manipulation",onClick:t=>L(t,e.id),"aria-label":"Delete property",children:(0,s.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("path",{d:"M14 3.98667C11.78 3.76667 9.54667 3.65333 7.32 3.65333C6 3.65333 4.68 3.72 3.36 3.85333L2 3.98667",stroke:"#D14848",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M5.66669 3.31999L5.81335 2.43999C5.92002 1.80666 6.00002 1.33333 7.12669 1.33333H8.87335C10 1.33333 10.0867 1.83999 10.1867 2.44666L10.3334 3.31999",stroke:"#D14848",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M12.5667 6.09333L12.1334 12.8067C12.06 13.8533 12 14.6667 10.14 14.6667H5.86002C4.00002 14.6667 3.94002 13.8533 3.86668 12.8067L3.43335 6.09333",stroke:"#D14848",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M6.88669 11H9.10669",stroke:"#D14848",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M6.33331 8.33333H9.66665",stroke:"#D14848",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]})}),(0,s.jsxs)("div",{className:"flex flex-row justify-between items-center pr-6",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsx)("h3",{className:"font-bold text-[14px] leading-[19px] text-[#0B1420]",children:e.address||"Property"}),(0,s.jsx)("p",{className:"font-normal text-[12px] leading-[16px] text-[#515964]",children:e.description||e.property_type||"No description"})]}),(0,s.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M5.94001 13.2799L10.6 8.61989C11.14 8.07989 11.14 7.17989 10.6 6.63989L5.94001 1.97989",stroke:"#1C2C40",strokeWidth:"1.5",strokeMiterlimit:"10",strokeLinecap:"round",strokeLinejoin:"round"})})]})]},e.id))})]})}),(0,s.jsxs)("div",{className:"w-full px-4 fixed bottom-0 left-0 right-0 flex flex-col items-center pb-6 pt-4 bg-gradient-to-t from-[#FBF5DA] to-transparent max-w-[390px] mx-auto safe-area-bottom",children:[(0,s.jsx)("button",{onClick:()=>o.push("/properties/addunit"),className:"w-full h-[56px] flex flex-row justify-center items-center py-[18px] bg-[#1C2C40] rounded-[16px] active:bg-[#283c56] transition-colors touch-manipulation",children:(0,s.jsx)("span",{className:"font-bold text-[16px] leading-[22px] text-[#D1E7E2]",children:y.length>0?"Add Another Home":"Add New Home"})}),(0,s.jsx)("button",{className:"mt-3 text-center font-semibold text-[#0B1420] text-sm",onClick:()=>N(!0),children:"Why Add Your Home?"})]}),(0,s.jsx)(f.M,{children:k&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"fixed inset-0 bg-black bg-opacity-50 z-40 h-full w-full",style:{position:"fixed",top:0,left:0,right:0,bottom:0},onClick:()=>N(!1)}),(0,s.jsxs)(h.E.div,{ref:z,initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},className:"flex flex-col items-center p-0 pb-8 fixed w-full max-w-[390px] h-[318px] left-0 right-0 bottom-0 mx-auto bg-white rounded-t-2xl z-50",children:[(0,s.jsx)("div",{className:"flex flex-col items-center p-2.5 w-full",children:(0,s.jsx)("div",{className:"w-24 h-1.5 bg-[#ECECEC] rounded-3xl"})}),(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4 px-8",children:[(0,s.jsxs)("div",{className:"w-20 h-20 relative bg-[#FFF6ED] rounded-full flex items-center justify-center overflow-hidden",children:[(0,s.jsx)("img",{src:"/images/home.png",className:"w-12 h-12 object-contain",onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="block"}}),(0,s.jsx)("div",{style:{display:"none"},className:"text-[#55A363] text-4xl",children:"\uD83C\uDFE0"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,s.jsx)("h2",{className:"font-bold text-lg text-center text-[#0B1420]",children:"Why Add Your Home?"}),(0,s.jsx)("p",{className:"font-normal text-sm text-center text-[#2E3642] mt-1",children:"Adding your home creates a private, time-stamped record that protects your deposit like a digital receipt for move-in day."})]}),(0,s.jsx)("button",{onClick:()=>N(!1),className:"mt-4 w-full h-[56px] flex justify-center items-center bg-[#1C2C40] rounded-[16px]",children:(0,s.jsx)("span",{className:"font-bold text-[16px] text-[#D1E7E2]",children:"Got it"})})]})]})]})})]})]}):null}}},function(e){e.O(0,[1664,4105,2888,9774,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);